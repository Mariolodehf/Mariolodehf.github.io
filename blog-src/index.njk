---
layout: layout.njk
pagination:
  data: collections.post
  size: 10
  alias: posts
permalink: /blog/
---
<h1>Blog</h1>
<p class="lead">Artículos, notas y experiencias en telecomunicaciones, seguridad e innovación.</p>
<input id="busqueda" type="search" placeholder="Buscar..." aria-label="Buscar artículos" class="blog-search" />
<ul class="lista-posts" id="lista-posts" data-count="{{ posts.length }}">
{% for post in posts | reverse %}
  <li class="post-item" data-url="{{ post.url }}" data-tags="{% if post.data.tags %}{{ post.data.tags | join(',') }}{% endif %}">
    <article>
      <h2><a href="{{ post.url }}">{{ post.data.title }}</a></h2>
      <p class="meta">{{ post.date | date("%Y-%m-%d") }} · {{ post.templateContent | readTime }} min</p>
      {% if post.data.summary %}<p class="summary">{{ post.data.summary }}</p>{% endif %}
      {% if post.data.tags %}<p class="tags">{% for tag in post.data.tags %}<span class="tag">{{ tag }}</span>{% endfor %}</p>{% endif %}
    </article>
  </li>
{% endfor %}
</ul>
<p id="resultados-info" class="result-info" aria-live="polite"></p>
<script>
(function(){
  const input = document.getElementById('busqueda');
  const lista = document.getElementById('lista-posts');
  const info = document.getElementById('resultados-info');
  let indice = [];
  fetch('/blog/posts.json')
    .then(r => r.json())
    .then(json => { indice = json; actualizar(''); })
    .catch(()=>{ indice = []; });
  function normalizar(t){return t.toLowerCase();}
  function score(post, q){
    if(!q) return 0;
    let s=0; const nq=normalizar(q);
    const titulo=normalizar(post.title), resumen=normalizar(post.summary||''), tags=(post.tags||[]).map(normalizar).join(' ');
    if(titulo.includes(nq)) s+=3;
    if(resumen.includes(nq)) s+=1;
    if(tags.includes(nq)) s+=2;
    return s;
  }
  function actualizar(q){
    const ul = lista; ul.innerHTML='';
    let resultados = indice.map(p=>({p, sc: score(p,q)}));
    if(q) resultados = resultados.filter(r=>r.sc>0);
    resultados.sort((a,b)=> b.sc - a.sc);
    resultados.forEach(r=>{
      const li=document.createElement('li'); li.className='post-item';
      li.innerHTML = `<article><h2><a href="${r.p.url}">${r.p.title}</a></h2>`+
        `<p class="meta">${r.p.date||''}</p>`+
        (r.p.summary?`<p class="summary">${r.p.summary}</p>`:'')+
        (r.p.tags&&r.p.tags.length?`<p class="tags">${r.p.tags.map(t=>`<span class=tag>${t}</span>`).join(' ')}</p>`:'')+
        `</article>`;
      ul.appendChild(li);
    });
    if(info){
      info.textContent = q ? `${resultados.length} resultado(s)` : '';
    }
  }
  if(input){
    input.addEventListener('input', ()=> actualizar(input.value.trim()));
  }
})();
</script>
